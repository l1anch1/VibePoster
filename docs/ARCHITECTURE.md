# ç³»ç»Ÿæ¶æ„ä¸å®ç°

> **ç»Ÿä¸€æ–‡æ¡£** - æ¶æ„è®¾è®¡ + å®ç°çŠ¶æ€ + æŠ€æœ¯æ ˆè¯´æ˜

---

## ğŸ“‹ ç›®å½•

1. [æ¶æ„æ¦‚è§ˆ](#æ¶æ„æ¦‚è§ˆ)
2. [ç›®å½•ç»“æ„](#ç›®å½•ç»“æ„)
3. [åˆ†å±‚è®¾è®¡](#åˆ†å±‚è®¾è®¡)
4. [æ ¸å¿ƒæ¨¡å—](#æ ¸å¿ƒæ¨¡å—)
5. [çŸ¥è¯†æ¨¡å—](#çŸ¥è¯†æ¨¡å—)
6. [å®ç°çŠ¶æ€](#å®ç°çŠ¶æ€)
7. [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)

---

## æ¶æ„æ¦‚è§ˆ

### æ•´ä½“æ¶æ„

```plaintext
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Frontend                                  â”‚
â”‚              (React + TypeScript + Tailwind CSS)                â”‚
â”‚                    iOS Liquid Glass Style                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ HTTP/REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Backend (FastAPI)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              API Layer (routes/)                            â”‚ â”‚
â”‚  â”‚       ç»Ÿä¸€å“åº”æ ¼å¼ + ä¾èµ–æ³¨å…¥ + å‚æ•°éªŒè¯                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚            Service Layer (services/)                        â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  PosterService  â”‚ â”‚KnowledgeService â”‚ â”‚RendererServiceâ”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚         Workflow (LangGraph Orchestration)                  â”‚ â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚  â”‚   â”‚ Planner â”‚ Visual  â”‚   Layout    â”‚     Critic      â”‚    â”‚ â”‚
â”‚  â”‚   â”‚  Agent  â”‚ Agent   â”‚   Agent     â”‚     Agent       â”‚    â”‚ â”‚
â”‚  â”‚   â”‚  (KG+RAG)â”‚        â”‚  (DSL/OOP)  â”‚                 â”‚    â”‚ â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Knowledge Layer (knowledge/)                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚DesignKnowledgeGraph â”‚  â”‚   BrandKnowledgeBase (RAG)  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚    (networkx)       â”‚  â”‚  (sentence-transformers)    â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Tools Layer (tools/)                           â”‚ â”‚
â”‚  â”‚  â€¢ OCR + å›¾åƒç†è§£ â€¢ æŠ å›¾ â€¢ ç´ ææœç´¢                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Core Layer (core/)                             â”‚ â”‚
â”‚  â”‚  â€¢ Config â€¢ LLM â€¢ Logger â€¢ Interfaces â€¢ Dependencies        â”‚ â”‚
â”‚  â”‚  â€¢ OOP Layout Engine â€¢ Exceptions                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Render Service (Node.js)                           â”‚
â”‚                   PSD ç”Ÿæˆä¸ä¸‹è½½                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç›®å½•ç»“æ„

```plaintext
VibePoster/
â”œâ”€â”€ frontend/                    # å‰ç«¯ (React + Tailwind CSS)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/         # React ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ editor/         # ç¼–è¾‘å™¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ landing/        # è½åœ°é¡µç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ poster/         # æµ·æŠ¥å±•ç¤ºç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ config/             # é…ç½®å¸¸é‡
â”‚   â”‚   â”œâ”€â”€ services/           # API æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ hooks/              # è‡ªå®šä¹‰ Hooks
â”‚   â”‚   â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ types/              # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ App.tsx             # ä¸»åº”ç”¨
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ engine/                  # æµ·æŠ¥ç”Ÿæˆå¼•æ“ (Python/FastAPI)
â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”‚   â”œâ”€â”€ api/            # API è·¯ç”±å±‚
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ schemas.py         # è¯·æ±‚æ¨¡å‹ï¼ˆä»…è¯·æ±‚ï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ middleware.py      # ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ routes/
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ poster.py      # æµ·æŠ¥ç”Ÿæˆè·¯ç”±
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ knowledge.py   # çŸ¥è¯†æ¨¡å—è·¯ç”± (KG + RAG)
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ workflow/       # å·¥ä½œæµæ¨¡å—ï¼ˆLangGraph ç¼–æ’ï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ orchestrator.py    # å·¥ä½œæµç¼–æ’ï¼ˆèŠ‚ç‚¹è¿æ¥ï¼‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ state.py           # AgentState å®šä¹‰
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ core/           # æ ¸å¿ƒåŸºç¡€è®¾æ–½
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ config.py          # é…ç½®ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ llm.py             # LLM å®¢æˆ·ç«¯å·¥å‚
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ logger.py          # æ—¥å¿—ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ exceptions.py      # å¼‚å¸¸å®šä¹‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ interfaces.py      # æ¥å£æŠ½è±¡
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ dependencies.py    # ä¾èµ–æ³¨å…¥
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ utils.py           # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ layout/            # OOP å¸ƒå±€å¼•æ“
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ styles.py      # æ ·å¼å®šä¹‰
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ elements.py    # å…ƒç´ å®šä¹‰
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ containers.py  # å®¹å™¨å®šä¹‰
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ models/         # é¢†åŸŸæ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ poster.py         # æµ·æŠ¥æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ response.py       # ç»Ÿä¸€ API å“åº”æ¨¡å‹
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ knowledge/      # çŸ¥è¯†æ¨¡å—
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ kg/               # Knowledge Graph å­æ¨¡å—
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ kg_rules.json
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ design_rules.py
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ rag/              # RAG å­æ¨¡å—
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ data/
â”‚   â”‚   â”‚   â”‚       â”‚   â””â”€â”€ default_brand_knowledge.json
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ rag_engine.py
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ agents/         # Agent å±‚ï¼ˆAI å†³ç­–ï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ base.py            # Agent åŸºç±»
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ planner.py         # Planner Agent (é›†æˆKG+RAG)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ visual.py          # Visual Agent
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ layout.py          # Layout Agent (æ”¯æŒDSL)
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ critic.py          # Critic Agent
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ services/       # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ poster_service.py  # æµ·æŠ¥ç”ŸæˆæœåŠ¡
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ knowledge_service.py # çŸ¥è¯†æœåŠ¡
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ renderer/          # æ¸²æŸ“æœåŠ¡
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ dsl_parser.py
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ schema_converter.py
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ service.py
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ tools/          # å·¥å…·å±‚ï¼ˆå…·ä½“å®ç°ï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ asset_library.json
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ vision.py          # æŠ å›¾ã€å›¾åƒåˆæˆ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ image_understanding.py  # OCR + å›¾åƒç†è§£
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ asset_db.py        # ç´ ææœç´¢
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ prompts/        # Prompt ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ templates.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ dsl_templates.py
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ manager.py
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ main.py         # FastAPI å…¥å£
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ tests/              # æµ‹è¯•ç›®å½•
â”‚   â”‚
â”‚   â””â”€â”€ render/                  # PSD æ¸²æŸ“æœåŠ¡ (Node.js)
â”‚
â”œâ”€â”€ docs/                        # æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ README.md                       # æ–‡æ¡£ç´¢å¼•
â”‚   â”œâ”€â”€ ARCHITECTURE.md                 # æ¶æ„è¯´æ˜ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â”‚   â”œâ”€â”€ ONLINE_EDITOR_IMPLEMENTATION.md # åœ¨çº¿ç¼–è¾‘å™¨å®ç°
â”‚   â”œâ”€â”€ TASK_REQUIREMENTS_ANALYSIS.md   # ä»»åŠ¡éœ€æ±‚åˆ†æ
â”‚   â”œâ”€â”€ VISUAL_AGENT_ARCHITECTURE_ANALYSIS.md
â”‚   â”œâ”€â”€ OCR_AND_IMAGE_UNDERSTANDING.md
â”‚   â”œâ”€â”€ CONFIGURATION.md
â”‚   â”œâ”€â”€ DEPENDENCY_INJECTION.md
â”‚   â””â”€â”€ EXCEPTION_HANDLING.md
â”‚
â”œâ”€â”€ docker-compose.yml           # Docker ç¼–æ’
â””â”€â”€ README.md                    # é¡¹ç›®ä¸» README
```

---

## åˆ†å±‚è®¾è®¡

### 1. API å±‚ (`api/`)

**èŒè´£**ï¼š
- æ¥æ”¶ HTTP è¯·æ±‚
- å‚æ•°éªŒè¯ï¼ˆPydanticï¼‰
- é€šè¿‡ä¾èµ–æ³¨å…¥è·å–æœåŠ¡
- è¿”å›ç»Ÿä¸€æ ¼å¼çš„å“åº”

**è·¯ç”±æ‹†åˆ†**ï¼š
- `routes/poster.py`: æµ·æŠ¥ç”Ÿæˆæ¥å£ `/api/generate_multimodal`
- `routes/knowledge.py`: çŸ¥è¯†æ¨¡å—æ¥å£ `/api/kg/*`, `/api/brand/*`

**æ¨¡å‹åˆ†ç¦»**ï¼š
- `schemas.py`: ä»…åŒ…å«è¯·æ±‚æ¨¡å‹
- `models/response.py`: ç»Ÿä¸€å“åº”æ¨¡å‹

**ç»Ÿä¸€å“åº”æ ¼å¼**ï¼ˆå®šä¹‰åœ¨ `models/response.py`ï¼‰ï¼š
```python
class APIResponse(BaseModel, Generic[T]):
    success: bool = True
    data: Optional[T] = None
    message: str = "æ“ä½œæˆåŠŸ"
```

### 2. æœåŠ¡å±‚ (`services/`)

**èŒè´£**ï¼š
- å°è£…ä¸šåŠ¡é€»è¾‘
- åè°ƒå¤šä¸ªæ¨¡å—
- ä¸æ¶‰åŠ HTTP è¯·æ±‚/å“åº”

**æ ¸å¿ƒæœåŠ¡**ï¼š
- `PosterService`: æµ·æŠ¥ç”Ÿæˆä¸»æœåŠ¡
- `KnowledgeService`: ç»Ÿä¸€ç®¡ç† KG + RAG
- `RendererService`: OOP å¸ƒå±€æ¸²æŸ“

### 3. Agent å±‚ (`agents/`)

**èŒè´£**ï¼š
- AI å†³ç­–å’Œè§„åˆ’
- è°ƒç”¨ LLM
- åè°ƒå·¥å…·å±‚

**å››å¤§ Agent**ï¼š
- **Planner**: å°†ç”¨æˆ·éœ€æ±‚è½¬åŒ–ä¸ºè®¾è®¡ç®€æŠ¥ï¼ˆé›†æˆ KG + RAGï¼‰
- **Visual**: å¤„ç†å›¾ç‰‡ï¼ˆæŠ å›¾ã€OCRã€å›¾åƒç†è§£ã€ç´ ææœç´¢ï¼‰
- **Layout**: ç”Ÿæˆæµ·æŠ¥å¸ƒå±€ï¼ˆæ”¯æŒ DSL æ¨¡å¼ï¼Œä½¿ç”¨ OOP å¸ƒå±€å¼•æ“ï¼‰
- **Critic**: å®¡æ ¸æµ·æŠ¥è´¨é‡ï¼Œæä¾›åé¦ˆ

### 4. çŸ¥è¯†å±‚ (`knowledge/`)

**èŒè´£**ï¼š
- å­˜å‚¨å’Œæ¨ç†è®¾è®¡è§„åˆ™
- æ£€ç´¢ä¼ä¸šå“ç‰ŒçŸ¥è¯†

**ç›®å½•ç»“æ„**ï¼š
```
knowledge/
â”œâ”€â”€ kg/                  # Knowledge Graph å­æ¨¡å—
â”‚   â””â”€â”€ design_rules.py  # è®¾è®¡è§„åˆ™æ¨ç†å¼•æ“
â”œâ”€â”€ rag/                 # RAG å­æ¨¡å—
â”‚   â””â”€â”€ rag_engine.py    # å“ç‰ŒçŸ¥è¯†æ£€ç´¢å¼•æ“
â””â”€â”€ __init__.py          # ç»Ÿä¸€å¯¼å‡º
```

**æ•°æ®æ–‡ä»¶** (`data/`)ï¼š
- `kg_rules.json`: KG è§„åˆ™æ•°æ®ï¼ˆè¡Œä¸š/æ°›å›´ â†’ é¢œè‰²/å­—ä½“/å¸ƒå±€ï¼‰
- `default_brand_knowledge.json`: RAG é»˜è®¤å“ç‰ŒçŸ¥è¯†ï¼ˆåä¸ºå“ç‰Œæ•°æ®ï¼‰

**æ¨¡å—**ï¼š
- `DesignKnowledgeGraph`: ä½¿ç”¨ networkx å­˜å‚¨è¡Œä¸šâ†’é¢œè‰²/å­—ä½“/å¸ƒå±€çš„è§„åˆ™
- `BrandKnowledgeBase`: ä½¿ç”¨ sentence-transformers å®ç° RAG æ£€ç´¢

### 5. å·¥å…·å±‚ (`tools/`)

**èŒè´£**ï¼š
- å…·ä½“çš„æŠ€æœ¯å®ç°
- å›¾åƒå¤„ç†ï¼ˆæŠ å›¾ã€åˆæˆï¼‰
- OCR + å›¾åƒç†è§£
- ç´ ææœç´¢

### 6. æ ¸å¿ƒå±‚ (`core/`)

**èŒè´£**ï¼š
- é…ç½®ç®¡ç† (`config.py`)
- LLM å®¢æˆ·ç«¯å·¥å‚ (`llm.py`)
- æ—¥å¿—ç³»ç»Ÿ (`logger.py`)
- å¼‚å¸¸å®šä¹‰ (`exceptions.py`)
- æ¥å£æŠ½è±¡ (`interfaces.py`)
- ä¾èµ–æ³¨å…¥ (`dependencies.py`)
- OOP å¸ƒå±€å¼•æ“ (`layout/`)

**æ³¨æ„**ï¼šå·¥ä½œæµç›¸å…³ä»£ç å·²ç§»è‡³ `workflow/` æ¨¡å—ã€‚

### 7. å·¥ä½œæµæ¨¡å— (`workflow/`)

**èŒè´£**ï¼š
- å®šä¹‰å·¥ä½œæµçŠ¶æ€ (`state.py`)
- LangGraph ç¼–æ’ (`orchestrator.py`)
- èŠ‚ç‚¹è¿æ¥å’Œæ¡ä»¶è¾¹

**ç»“æ„**ï¼š
```
workflow/
â”œâ”€â”€ __init__.py           # æ¨¡å—å¯¼å‡º
â”œâ”€â”€ state.py              # AgentState å®šä¹‰
â””â”€â”€ orchestrator.py       # å·¥ä½œæµç¼–æ’
```

---

## æ ¸å¿ƒæ¨¡å—

### 1. ä¾èµ–æ³¨å…¥ (`core/dependencies.py`)

ä½¿ç”¨ `ServiceContainer` ç»Ÿä¸€ç®¡ç†æ‰€æœ‰æœåŠ¡å•ä¾‹ï¼š

```python
class ServiceContainer:
    _poster_service = None
    _knowledge_service = None
    _knowledge_graph = None
    _knowledge_base = None
    _renderer_service = None
    
    @classmethod
    def reset_all(cls):
        """é‡ç½®æ‰€æœ‰æœåŠ¡ï¼ˆç”¨äºæµ‹è¯•ï¼‰"""
        ...

def get_knowledge_service() -> KnowledgeService:
    """è·å–çŸ¥è¯†æœåŠ¡ï¼ˆå•ä¾‹ï¼‰"""
    ...
```

### 2. æ¥å£æŠ½è±¡ (`core/interfaces.py`)

å®šä¹‰æ ¸å¿ƒæ¥å£ï¼Œå®ç°ä¾èµ–å€’ç½®ï¼š

```python
class IKnowledgeGraph(ABC):
    @abstractmethod
    def infer_rules(self, keywords: List[str]) -> Dict[str, Any]: ...

class IKnowledgeBase(ABC):
    @abstractmethod
    def search(self, query: str, top_k: int) -> List[Dict]: ...
```

### 3. OOP å¸ƒå±€å¼•æ“ (`core/layout/`)

æ›¿ä»£ç¡¬ç¼–ç åæ ‡è®¡ç®—ï¼Œä½¿ç”¨å®¹å™¨+ç»„ä»¶çš„æµå¼å¸ƒå±€ï¼š

```python
class Element(ABC):
    """å…ƒç´ åŸºç±»"""
    ...

class TextBlock(Element):
    """æ–‡æœ¬å— - è‡ªåŠ¨è®¡ç®—é«˜åº¦"""
    ...

class VerticalContainer(Container):
    """å‚ç›´å®¹å™¨ - ç±»ä¼¼ CSS Flexbox"""
    def arrange(self): ...
```

### 4. çŸ¥è¯†æœåŠ¡ (`services/knowledge_service.py`)

ç»Ÿä¸€ç®¡ç† KG å’Œ RAGï¼š

```python
class KnowledgeService:
    def get_design_context(self, user_prompt, brand_name) -> Dict:
        """è·å–å®Œæ•´çš„è®¾è®¡ä¸Šä¸‹æ–‡ï¼ˆKG + RAGï¼‰"""
        # 1. ä» prompt æå–å…³é”®è¯
        keywords = self.extract_keywords(user_prompt)
        # 2. KG æ¨ç†è®¾è®¡è§„åˆ™
        kg_rules = self.infer_design_rules(keywords)
        # 3. RAG æ£€ç´¢å“ç‰ŒçŸ¥è¯†
        brand_knowledge = self.search_brand_knowledge(...)
        return {...}
```

---

## çŸ¥è¯†æ¨¡å—

### Knowledge Graph (è®¾è®¡è§„åˆ™æ¨ç†)

**å­˜å‚¨ç»“æ„**ï¼š
```
Industry/Vibe â†’ Color/Font/Layout
     â†“              â†“
   Tech  â”€â”€â”€â”€â”€â”€â”€â†’  #0066FF (ç§‘æŠ€è“)
                   Sans-Serif
                   Grid Layout
```

**ä½¿ç”¨æ–¹å¼**ï¼š
```python
kg = DesignKnowledgeGraph()
rules = kg.infer_rules(["Tech", "Promotion"])
# {
#   "recommended_colors": ["#0066FF", "#FF4444"],
#   "recommended_fonts": ["Helvetica", "Arial"],
#   "recommended_layouts": ["Grid", "Center"]
# }
```

### RAG Engine (å“ç‰ŒçŸ¥è¯†æ£€ç´¢)

**æŠ€æœ¯æ ˆ**ï¼š
- è½»é‡çº§ï¼š`sentence-transformers` (paraphrase-multilingual-MiniLM-L12-v2)
- å®Œæ•´ç‰ˆï¼š`langchain` + `chromadb`ï¼ˆå¯é€‰ï¼‰

**ä½¿ç”¨æ–¹å¼**ï¼š
```python
rag = BrandKnowledgeBase()
rag.add_document("åä¸ºå“ç‰Œä¸»è‰²è°ƒæ˜¯æ˜†ä»‘çº¢...", {"brand": "åä¸º"})
results = rag.search("åä¸ºçš„é…è‰²", top_k=2)
```

---

## å®ç°çŠ¶æ€

### âœ… å·²å®Œæˆ

#### æ ¸å¿ƒåŸºç¡€è®¾æ–½
- âœ… é…ç½®ç®¡ç†ç³»ç»Ÿï¼ˆPydantic Settings V2ï¼‰
- âœ… LLM å®¢æˆ·ç«¯å·¥å‚ï¼ˆDeepSeekã€Geminiï¼‰
- âœ… ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿ
- âœ… å…¨å±€å¼‚å¸¸å¤„ç†
- âœ… ä¾èµ–æ³¨å…¥ç³»ç»Ÿï¼ˆServiceContainerï¼‰
- âœ… æ¥å£æŠ½è±¡ï¼ˆIKnowledgeGraph, IKnowledgeBaseï¼‰

#### çŸ¥è¯†æ¨¡å—
- âœ… Knowledge Graph è®¾è®¡è§„åˆ™æ¨ç†
- âœ… RAG å“ç‰ŒçŸ¥è¯†æ£€ç´¢
- âœ… KnowledgeService ç»Ÿä¸€ç®¡ç†
- âœ… API ç«¯ç‚¹ï¼ˆ/api/kg/infer, /api/brand/upload, /api/brand/searchï¼‰

#### Agent å±‚
- âœ… Planner Agentï¼ˆé›†æˆ KG + RAGï¼‰
- âœ… Visual Agentï¼ˆOCR + å›¾åƒç†è§£ + æŠ å›¾ + ç´ ææœç´¢ï¼‰
- âœ… Layout Agentï¼ˆæ”¯æŒ DSL æ¨¡å¼ï¼‰
- âœ… Critic Agentï¼ˆè´¨é‡å®¡æ ¸ï¼‰

#### å¸ƒå±€å¼•æ“
- âœ… OOP å¸ƒå±€å¼•æ“ï¼ˆElement, Containerï¼‰
- âœ… RendererServiceï¼ˆDSL è§£æ + Pydantic è½¬æ¢ï¼‰

#### å‰ç«¯
- âœ… React + TypeScript + Tailwind CSS
- âœ… iOS Liquid Glass é£æ ¼
- âœ… Landing Page
- âœ… åœ¨çº¿ç¼–è¾‘å™¨ï¼ˆå›¾å±‚é€‰æ‹©ã€æ‹–æ‹½ã€å±æ€§ç¼–è¾‘ï¼‰
- âœ… å“ç‰Œæ–‡æ¡£ä¸Šä¼ åŠŸèƒ½

#### Docker
- âœ… Dockerfileï¼ˆfrontend, engine, renderï¼‰
- âœ… docker-compose.yml

### ğŸ—‘ï¸ å·²åˆ é™¤

- ~~`templates/` é£æ ¼æ¨¡æ¿ç³»ç»Ÿ~~ â†’ å·²åˆ é™¤ï¼Œè¢« KG + RAG å®Œå…¨æ›¿ä»£

---

## æŠ€æœ¯æ ˆ

### åç«¯ (Python/FastAPI)

| ç±»åˆ« | æŠ€æœ¯ | ç”¨é€” |
|------|------|------|
| **Web æ¡†æ¶** | FastAPI | RESTful API æœåŠ¡ |
| **AI ç¼–æ’** | LangGraph | Agent å·¥ä½œæµç¼–æ’ |
| **LLM** | DeepSeek, Gemini | å¤§è¯­è¨€æ¨¡å‹ |
| **å›¾åƒå¤„ç†** | Pillow, rembg | å›¾åƒåˆæˆã€æŠ å›¾ |
| **çŸ¥è¯†å›¾è°±** | networkx | è®¾è®¡è§„åˆ™å­˜å‚¨ä¸æ¨ç† |
| **å‘é‡æ£€ç´¢** | sentence-transformers | RAG è¯­ä¹‰æ£€ç´¢ |
| **æ•°æ®éªŒè¯** | Pydantic V2 | æ•°æ®æ¨¡å‹å’Œé…ç½®ç®¡ç† |
| **æµ‹è¯•** | Pytest | å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯• |

### æ¸²æŸ“æœåŠ¡ (Node.js)

| ç±»åˆ« | æŠ€æœ¯ | ç”¨é€” |
|------|------|------|
| **Web æ¡†æ¶** | Express.js | HTTP æœåŠ¡ |
| **PSD ç”Ÿæˆ** | ag-psd | PSD æ–‡ä»¶ç”Ÿæˆ |
| **å›¾åƒå¤„ç†** | sharp | å›¾åƒè°ƒæ•´å’Œè½¬æ¢ |

### å‰ç«¯ (React)

| ç±»åˆ« | æŠ€æœ¯ | ç”¨é€” |
|------|------|------|
| **æ¡†æ¶** | React 18 | UI æ¡†æ¶ |
| **è¯­è¨€** | TypeScript | ç±»å‹å®‰å…¨ |
| **æ„å»ºå·¥å…·** | Vite | å¼€å‘å’Œæ„å»º |
| **æ ·å¼** | Tailwind CSS v4 | åŸå­åŒ– CSS |
| **HTTP å®¢æˆ·ç«¯** | Axios | API è°ƒç”¨ |

---

## è®¾è®¡åŸåˆ™

### 1. åˆ†å±‚æ¶æ„
- æ¸…æ™°çš„å±‚æ¬¡åˆ’åˆ†ï¼ˆAPI â†’ Service â†’ Workflow â†’ Agent â†’ Knowledge â†’ Tools â†’ Coreï¼‰
- å•å‘ä¾èµ–ï¼ˆä¸Šå±‚ä¾èµ–ä¸‹å±‚ï¼Œä¸‹å±‚ä¸ä¾èµ–ä¸Šå±‚ï¼‰
- ä¸šåŠ¡é€»è¾‘ä¸åŸºç¡€è®¾æ–½åˆ†ç¦»ï¼ˆworkflow/ vs core/ï¼‰

### 2. ä¾èµ–å€’ç½®
- é€šè¿‡æ¥å£æŠ½è±¡ï¼ˆ`IKnowledgeGraph`, `IKnowledgeBase`ï¼‰å®ç°è§£è€¦
- ä¾¿äºæµ‹è¯•æ—¶ Mock

### 3. å•ä¸€èŒè´£
- æ¯ä¸ªæ¨¡å—åªè´Ÿè´£ä¸€ä»¶äº‹
- Agent åªåšå†³ç­–ï¼ŒService å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼ŒTools åšå…·ä½“å®ç°

### 4. ç»Ÿä¸€è§„èŒƒ
- ç»Ÿä¸€çš„é”™è¯¯å¤„ç†
- ç»Ÿä¸€çš„æ—¥å¿—æ ¼å¼
- ç»Ÿä¸€çš„ API å“åº”æ ¼å¼

---

**æœ€åæ›´æ–°**: 2025-01-08
